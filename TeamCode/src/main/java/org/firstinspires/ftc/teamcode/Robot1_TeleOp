package org.firstinspires.ftc.teamcode;

import com.qualcomm.robotcore.eventloop.opmode.OpMode;
import com.qualcomm.robotcore.eventloop.opmode.TeleOp;
import com.qualcomm.robotcore.hardware.HardwareMap;

@TeleOp(name="Robot1 TeleOp", group="Iterative Opmode")
public class Robot1_TeleOp extends OpMode {

    Robot1_Hardware hardware;

    //Power variables
    private double leftPower,
        rightPower,
        boost,
        middlePower;
    
    // Power control variables
    private double MAX_MIDDLE_POWER = 0.5;
    private double MAX_DRIVE_POWER = 0.5;

    private int driveMode;

    public void init() {
        //Initialize hardware
        hardware = new Robot1_Hardware(hardwareMap);
        hardware.initHardware();

        //Assign variables
        boost = 0.7;
        rightPower = 0;
        leftPower = 0;
        driveMode = 1;
    }

    public void loop() {
        manageDrivetrain();
        applyBoost();
    }

    private void applyBoost() {
        if (gamepad1.x)
            boost = 1;
    }

    private void manageDrivetrain() {
        // sets drive mode
        if (gamepad1.left_bumper)
            driveMode = 1;
        if (gamepad1.right_bumper)
            driveMode = 2;

        if (driveMode == 1) {
            //drive1 controls (slide drive)
            if (gamepad1.left_trigger > 0) {
                middlePower = -MAX_MIDDLE_POWER; // strafe left
                leftPower = 0;
                rightPower = 0;
            } else if (gamepad1.right_trigger > 0) {
                middlePower = MAX_MIDDLE_POWER; // strafe right
                leftPower = 0;
                rightPower = 0;
            } else {
                // motor power = joysticks
                middlePower = 0;
                leftPower = -gamepad1.left_stick_y * MAX_DRIVE_POWER;
                rightPower = -gamepad1.right_stick_y * MAX_DRIVE_POWER;
            }
        } else {
            // drive2 controls (planetary drive)
            if (gamepad1.left_trigger == 0 && gamepad1.right_trigger == 0) {
                //Moving forward, backward, left, right
                leftPower = -gamepad1.left_stick_y * MAX_DRIVE_POWER;
                rightPower = -gamepad1.left_stick_y * MAX_DRIVE_POWER;
                middlePower = gamepad1.left_stick_x * MAX_MIDDLE_POWER;
            } else {
                // Turning
                if (gamepad1.left_trigger > 0) {
                    middlePower = 0;
                    leftPower = 0;
                    rightPower = MAX_DRIVE_POWER;
                } else if (gamepad1.right_trigger > 0) {
                    middlePower = 0;
                    leftPower = MAX_DRIVE_POWER;
                    rightPower = 0;
                }

            }
        }


        hardware.leftDrive.setPower(boost * leftPower);
        hardware.rightDrive.setPower(boost * rightPower);
        hardware.middleDrive.setPower(middlePower);
    }
}
